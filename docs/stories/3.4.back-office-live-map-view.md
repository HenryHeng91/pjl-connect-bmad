# Story 3.4: Back-Office Live Map View

**Status:** Draft

**Story:**
**As an** Ops Team Member,
**I want** to see the driver's real-time location on a map within the booking detail view,
**so that** I can monitor the shipment's progress visually.

**Acceptance Criteria:**
1.  The booking detail page in the Back Office displays an embedded map.
2.  If a driver is actively sharing their location, their live position is displayed and updated on the map.
3.  If tracking is not active, the map shows a "Tracking not started" status.

**Tasks / Subtasks:**
- [ ] Task 1 (AC: 1): Integrate a mapping library (e.g., Leaflet.js, Google Maps API) into the booking detail view.
- [ ] Task 2 (AC: 2): Create a new API endpoint in Laravel to fetch the latest known location of the driver for a given shipment.
- [ ] Task 3 (AC: 2): The frontend should periodically poll this endpoint to update the driver's position on the map.
- [ ] Task 4 (AC: 3): Implement the logic to display a "Tracking not started" status on the map if no location data is available.

**Dev Notes:**
*   **Core Workflow:** This story is part of the "Live Tracking & Customer Communication" workflow.
*   **Data Models:** This story will require a new table or a new set of fields in the `shipments` table to store the driver's location data.
*   **Backend:**
    *   Create a new controller and route for the location API endpoint. [Source: docs/architecture/backend-architecture.md]
*   **Frontend:**
    *   The booking detail view (`BookingDetailView.vue`) will need to be updated to include the map component. [Source: docs/architecture/frontend-architecture.md]
    *   Choose a suitable mapping library and implement the map component.
*   **Testing:**
    *   Backend tests (Pest/PHPUnit) should cover the location API endpoint. [Source: docs/architecture/testing-strategy.md]
    *   Frontend tests (Vitest) should cover the map component, including the display of the driver's location and the "Tracking not started" status. [Source: docs/architecture/testing-strategy.md]

**Change Log:**
| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| 2025-08-28 | 1.0 | Initial draft | Bob (SM) |

**Dev Agent Record:**
**Agent Model Used:**
**Debug Log References:**
**Completion Notes List:**
**File List:**

**QA Results:**