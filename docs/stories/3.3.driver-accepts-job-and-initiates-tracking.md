# Story 3.3: Driver Accepts Job & Initiates Tracking

**Status:** Draft

**Story:**
**As a** Driver,
**I want** to use the forwarded link to view job details and start sharing my location,
**so that** I can easily begin a tracked delivery.

**Acceptance Criteria:**
1.  When the driver clicks the unique link, they are shown key job details within their Telegram app.
2.  A "Start Tracking" button is present.
3.  Clicking the button prompts the driver to share their live location for an extended period.
4.  Once location sharing begins, the shipment status in the Back Office updates to "In Transit".

**Tasks / Subtasks:**
- [ ] Task 1 (AC: 1): Create a controller and view to handle the magic link route. The view should display the key job details to the driver.
- [ ] Task 2 (AC: 2): Add a "Start Tracking" button to the view.
- [ ] Task 3 (AC: 3): Implement the logic for the "Start Tracking" button to request live location sharing from the driver using the Telegram Bot API.
- [ ] Task 4 (AC: 4): Create a webhook handler to receive the live location updates from the driver's Telegram client.
- [ ] Task 5 (AC: 4): When the first location update is received, update the shipment status to "In Transit".

**Dev Notes:**
*   **External APIs:** This story requires integration with the Telegram Bot API to display a web page within the Telegram app and to handle live location sharing. [Source: docs/architecture/external-apis.md]
*   **Core Workflow:** This story is part of the "Live Tracking & Customer Communication" workflow.
*   **Data Models:** This story will update the `shipments` table. The schema is defined in `docs/architecture/database-schema.md`.
*   **Backend:**
    *   Create a new controller to handle the magic link route and the webhook for location updates. [Source: docs/architecture/backend-architecture.md]
*   **Frontend:**
    *   Create a simple view (e.g., a Blade view or a minimal Vue component) to display the job details to the driver. This view will be displayed within the Telegram app, so it should be lightweight and mobile-friendly.
*   **Testing:**
    *   Backend tests (Pest/PHPUnit) should cover the magic link controller, the location update webhook, and the status update logic. It would be beneficial to mock the Telegram API. [Source: docs/architecture/testing-strategy.md]

**Change Log:**
| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| 2025-08-28 | 1.0 | Initial draft | Bob (SM) |

**Dev Agent Record:**
**Agent Model Used:**
**Debug Log References:**
**Completion Notes List:**
**File List:**

**QA Results:**